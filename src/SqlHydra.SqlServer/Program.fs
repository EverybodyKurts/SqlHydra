open SqlHydra
open SqlHydra.SqlServer
open Schema

let sqlHydraId  = "SqlHydra.SqlServer"
let command     = "sqlhydra-mssql"
let readerType = "Microsoft.Data.SqlClient.SqlDataReader"
let comment     = $"// This code was generated by {sqlHydraId}."

[<EntryPoint>]
let main argv =

    let cfg = Console.getConfig()

    let formattedCode = 
        SqlServerSchemaProvider.getSchema cfg
        |> SchemaGenerator.generateModule cfg
        |> SchemaGenerator.toFormattedCode cfg comment

    System.IO.File.WriteAllText(cfg.OutputFile, formattedCode)
    0
