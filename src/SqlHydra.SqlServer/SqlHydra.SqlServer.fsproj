<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <OutputType>Exe</OutputType>
    <TargetFramework>netcoreapp3.1</TargetFramework>
    <Version>0.30.0</Version>
    <Authors>Jordan Marr</Authors>
    <Description>SqlHydra.SqlServer is a Myriad plugin that generates F# records a SQL Server database.</Description>
    <PackageLicenseFile>LICENSE</PackageLicenseFile>
    <GeneratePackageOnBuild>true</GeneratePackageOnBuild>    
  </PropertyGroup>
  
  <ItemGroup>
    <None Include="build\SqlHydra.SqlServer.InTest.props" />
    <Content Include="build\SqlHydra.SqlServer.props">
      <PackagePath>%(Identity)</PackagePath>
      <Visible>true</Visible>
      <Pack>true</Pack>
    </Content>
    <Compile Include="..\SqlHydra\Schema.fs" Link="Schema.fs" />
    <Compile Include="..\SqlHydra\SchemaGenerator.fs" Link="SchemaGenerator.fs" />
    <Compile Include="SqlServerDataTypes.fs" />
    <Compile Include="SqlServerGenerator.fs" />
    <Compile Include="SqlServerSchemaProvider.fs" />
    <Compile Include="Program.fs" />
  </ItemGroup>

  <ItemGroup>
    <PackageReference Include="Microsoft.Data.SqlClient" Version="2.1.3" />
    <PackageReference Include="Myriad.Core" Version="0.5.3" />
    <PackageReference Include="System.Text.Json" Version="5.0.2" />
    <PackageReference Update="FSharp.Core" Version="5.0.0" />
  </ItemGroup>

  <ItemGroup>
    <None Include="..\..\LICENSE">
      <Pack>True</Pack>
      <PackagePath></PackagePath>
    </None>
  </ItemGroup>
  
  <!--
    Include the .exe console app in the NuGet package.
  -->
  <PropertyGroup>
    <TargetsForTfmSpecificBuildOutput>
        $(TargetsForTfmSpecificBuildOutput);CopySqlHydraExeToProviderFolder
    </TargetsForTfmSpecificBuildOutput>
    <AllowedOutputExtensionsInPackageBuildOutputFolder>$(AllowedOutputExtensionsInPackageBuildOutputFolder);.json;.exe</AllowedOutputExtensionsInPackageBuildOutputFolder>
  </PropertyGroup>
  <Target Name="CopySqlHydraExeToProviderFolder" DependsOnTargets="ResolveReferences">
    <ItemGroup>
        <TfmSpecificPackageFile Include="$(OutputPath)\SqlHydra.*">
            <PackagePath>lib/$(TargetFramework)/Provider</PackagePath>
        </TfmSpecificPackageFile>
    </ItemGroup>
  </Target>

</Project>
